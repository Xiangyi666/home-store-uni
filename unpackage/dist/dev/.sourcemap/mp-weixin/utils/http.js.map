{"version":3,"file":"http.js","sources":["utils/http.js"],"sourcesContent":["class HttpRequest {\n    constructor() {\n        this.baseURL = 'http://localhost:8080/api'; // 你的后端地址\n    }\n\n    // 请求拦截器\n    interceptors(request) {\n        // 获取 token\n        const token = uni.getStorageSync('token');\n        console.log('token---', token)\n        // 添加 Authorization header\n        if (token) {\n            request.header = {\n                ...request.header,\n                'Authorization': `Bearer ${token}`\n            };\n        }\n        \n        return request;\n    }\n\n    // 发送请求\n    request(options) {\n        options = this.interceptors(options);\n        \n        return new Promise((resolve, reject) => {\n            uni.request({\n                url: this.baseURL + options.url,\n                method: options.method || 'GET',\n                data: options.data || {},\n                header: options.header || {},\n                success: (res) => {\n                    if (res.statusCode === 200) {\n                        resolve(res.data);\n                    } else if (res.statusCode === 401) {\n                        // Token 过期，跳转到登录页\n                        this.handleTokenExpired();\n                        reject(res.data);\n                    } else {\n                        reject(res.data);\n                    }\n                },\n                fail: (error) => {\n                    reject(error);\n                }\n            });\n        });\n    }\n\n    // 处理 token 过期\n    handleTokenExpired() {\n        // 清除 token\n        uni.removeStorageSync('token');\n        uni.removeStorageSync('user');\n        \n        // 跳转到登录页\n        uni.showModal({\n            title: '提示',\n            content: '登录已过期，请重新登录',\n            showCancel: false,\n            success: () => {\n                uni.navigateTo({\n                    url: '/pages/login/login'\n                });\n            }\n        });\n    }\n\n    // 快捷方法\n    get(url, data = {}) {\n        return this.request({ url, method: 'GET', data });\n    }\n\n    post(url, data = {}) {\n        return this.request({ url, method: 'POST', data });\n    }\n\n    put(url, data = {}) {\n        return this.request({ url, method: 'PUT', data });\n    }\n\n    delete(url, data = {}) {\n        return this.request({ url, method: 'DELETE', data });\n    }\n}\n\nexport default new HttpRequest();"],"names":["uni"],"mappings":";;AAAA,MAAM,YAAY;AAAA,EACd,cAAc;AACV,SAAK,UAAU;AAAA,EAClB;AAAA;AAAA,EAGD,aAAa,SAAS;AAElB,UAAM,QAAQA,cAAAA,MAAI,eAAe,OAAO;AACxCA,kBAAAA,MAAA,MAAA,OAAA,uBAAY,YAAY,KAAK;AAE7B,QAAI,OAAO;AACP,cAAQ,SAAS;AAAA,QACb,GAAG,QAAQ;AAAA,QACX,iBAAiB,UAAU,KAAK;AAAA,MAChD;AAAA,IACS;AAED,WAAO;AAAA,EACV;AAAA;AAAA,EAGD,QAAQ,SAAS;AACb,cAAU,KAAK,aAAa,OAAO;AAEnC,WAAO,IAAI,QAAQ,CAAC,SAAS,WAAW;AACpCA,oBAAAA,MAAI,QAAQ;AAAA,QACR,KAAK,KAAK,UAAU,QAAQ;AAAA,QAC5B,QAAQ,QAAQ,UAAU;AAAA,QAC1B,MAAM,QAAQ,QAAQ,CAAE;AAAA,QACxB,QAAQ,QAAQ,UAAU,CAAE;AAAA,QAC5B,SAAS,CAAC,QAAQ;AACd,cAAI,IAAI,eAAe,KAAK;AACxB,oBAAQ,IAAI,IAAI;AAAA,UACxC,WAA+B,IAAI,eAAe,KAAK;AAE/B,iBAAK,mBAAkB;AACvB,mBAAO,IAAI,IAAI;AAAA,UACvC,OAA2B;AACH,mBAAO,IAAI,IAAI;AAAA,UAClB;AAAA,QACJ;AAAA,QACD,MAAM,CAAC,UAAU;AACb,iBAAO,KAAK;AAAA,QACf;AAAA,MACjB,CAAa;AAAA,IACb,CAAS;AAAA,EACJ;AAAA;AAAA,EAGD,qBAAqB;AAEjBA,wBAAI,kBAAkB,OAAO;AAC7BA,wBAAI,kBAAkB,MAAM;AAG5BA,kBAAAA,MAAI,UAAU;AAAA,MACV,OAAO;AAAA,MACP,SAAS;AAAA,MACT,YAAY;AAAA,MACZ,SAAS,MAAM;AACXA,sBAAAA,MAAI,WAAW;AAAA,UACX,KAAK;AAAA,QACzB,CAAiB;AAAA,MACJ;AAAA,IACb,CAAS;AAAA,EACJ;AAAA;AAAA,EAGD,IAAI,KAAK,OAAO,IAAI;AAChB,WAAO,KAAK,QAAQ,EAAE,KAAK,QAAQ,OAAO,KAAI,CAAE;AAAA,EACnD;AAAA,EAED,KAAK,KAAK,OAAO,IAAI;AACjB,WAAO,KAAK,QAAQ,EAAE,KAAK,QAAQ,QAAQ,KAAI,CAAE;AAAA,EACpD;AAAA,EAED,IAAI,KAAK,OAAO,IAAI;AAChB,WAAO,KAAK,QAAQ,EAAE,KAAK,QAAQ,OAAO,KAAI,CAAE;AAAA,EACnD;AAAA,EAED,OAAO,KAAK,OAAO,IAAI;AACnB,WAAO,KAAK,QAAQ,EAAE,KAAK,QAAQ,UAAU,KAAI,CAAE;AAAA,EACtD;AACL;AAEA,MAAe,OAAA,IAAI,YAAa;;"}